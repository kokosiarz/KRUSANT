{"version":3,"sources":["../../src/payments/migrate-payments.ts"],"sourcesContent":["import { DataSource } from 'typeorm';\nimport { Student } from '../students/student.entity';\nimport { Payment } from '../payments/payment.entity';\n\nexport async function migratePaymentsToEntity(dataSource: DataSource) {\n  const studentRepo = dataSource.getRepository(Student);\n  const paymentRepo = dataSource.getRepository(Payment);\n  const students = await studentRepo.find();\n\n  for (const student of students) {\n    // @ts-ignore: payments may still exist in DB\n    const payments = (student as any).payments || [];\n    for (const p of payments) {\n      const payment = paymentRepo.create({\n        date: p.date,\n        amount: p.amount,\n        comment: p.comment,\n        studentId: student.id,\n      });\n      await paymentRepo.save(payment);\n    }\n  }\n  console.log('Payments migrated to Payment entity.');\n}\n\n// Usage example (run in a script):\n// import { AppDataSource } from '../data-source';\n// AppDataSource.initialize().then(() => migratePaymentsToEntity(AppDataSource));\n"],"names":["migratePaymentsToEntity","dataSource","studentRepo","getRepository","Student","paymentRepo","Payment","students","find","student","payments","p","payment","create","date","amount","comment","studentId","id","save","console","log"],"mappings":";;;;+BAIsBA;;;eAAAA;;;+BAHE;+BACA;AAEjB,eAAeA,wBAAwBC,UAAsB;IAClE,MAAMC,cAAcD,WAAWE,aAAa,CAACC,sBAAO;IACpD,MAAMC,cAAcJ,WAAWE,aAAa,CAACG,sBAAO;IACpD,MAAMC,WAAW,MAAML,YAAYM,IAAI;IAEvC,KAAK,MAAMC,WAAWF,SAAU;QAC9B,6CAA6C;QAC7C,MAAMG,WAAW,AAACD,QAAgBC,QAAQ,IAAI,EAAE;QAChD,KAAK,MAAMC,KAAKD,SAAU;YACxB,MAAME,UAAUP,YAAYQ,MAAM,CAAC;gBACjCC,MAAMH,EAAEG,IAAI;gBACZC,QAAQJ,EAAEI,MAAM;gBAChBC,SAASL,EAAEK,OAAO;gBAClBC,WAAWR,QAAQS,EAAE;YACvB;YACA,MAAMb,YAAYc,IAAI,CAACP;QACzB;IACF;IACAQ,QAAQC,GAAG,CAAC;AACd,EAEA,mCAAmC;CACnC,kDAAkD;CAClD,iFAAiF"}