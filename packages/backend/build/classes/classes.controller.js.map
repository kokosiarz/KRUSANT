{"version":3,"sources":["../../src/classes/classes.controller.ts"],"sourcesContent":["import {\n  Body,\n  Controller,\n  Param,\n  Query,\n  Get,\n  Post,\n  Patch,\n  Delete,\n} from '@nestjs/common';\nimport {\n  ApiTags,\n  ApiOperation,\n  ApiResponse,\n  ApiParam,\n  ApiQuery,\n  ApiBody,\n} from '@nestjs/swagger';\nimport { ClassesService } from './classes.service';\nimport { BatchUpsertClassDto } from './dto/batch-upsert-class.dto';\nimport { CreateClassDto } from './dto/create-class.dto';\nimport { UpdateClassDto } from './dto/update-class.dto';\n\n@ApiTags('classes')\n@Controller('classes')\nexport class ClassesController {\n  constructor(private readonly classesService: ClassesService) {}\n\n  @ApiOperation({ summary: 'Get all classes' })\n  @ApiQuery({\n    name: 'groupId',\n    required: false,\n    description: 'Filter by group ID',\n  })\n  @ApiResponse({\n    status: 200,\n    description: 'Returns all classes or filtered by group ID',\n  })\n  @Get()\n  async getAll(@Query('groupId') groupId?: string) {\n    const gid = groupId !== undefined ? Number(groupId) : undefined;\n    return await this.classesService.findAll(gid);\n  }\n\n  @ApiOperation({ summary: 'Get class by ID' })\n  @ApiParam({ name: 'id', description: 'Class ID' })\n  @ApiResponse({ status: 200, description: 'Returns class' })\n  @Get(':id')\n  async getOne(@Param('id') id: string) {\n    return await this.classesService.findOne(+id);\n  }\n\n  @ApiOperation({ summary: 'Create new class' })\n  @ApiBody({ type: CreateClassDto })\n  @ApiResponse({ status: 201, description: 'Class created' })\n  @Post()\n  async create(@Body() body: CreateClassDto) {\n    return await this.classesService.create(body);\n  }\n\n  @ApiOperation({ summary: 'Update class' })\n  @ApiParam({ name: 'id', description: 'Class ID' })\n  @ApiBody({ type: UpdateClassDto })\n  @ApiResponse({ status: 200, description: 'Class updated' })\n  @Patch(':id')\n  async update(@Param('id') id: string, @Body() body: UpdateClassDto) {\n    return await this.classesService.update(+id, body);\n  }\n\n  @ApiOperation({ summary: 'Delete class' })\n  @ApiParam({ name: 'id', description: 'Class ID' })\n  @ApiResponse({ status: 200, description: 'Class deleted' })\n  @Delete(':id')\n  async delete(@Param('id') id: string) {\n    await this.classesService.remove(+id);\n    return { message: 'Class deleted successfully' };\n  }\n\n  @ApiOperation({ summary: 'Set attendance for a class' })\n  @ApiParam({ name: 'id', description: 'Class ID' })\n  @ApiBody({ type: [Number] })\n  @ApiResponse({ status: 200, description: 'Attendance set, returns class and created debits' })\n  @Post(':id/attendance')\n  async setAttendance(\n    @Param('id') id: string,\n    @Body() attendedStudentsIds: number[],\n  ) {\n    return await this.classesService.setAttendance(+id, attendedStudentsIds);\n  }\n\n  @ApiOperation({\n    summary: 'Batch create or update classes by startTime and roomId',\n  })\n  @ApiBody({ type: BatchUpsertClassDto })\n  @ApiResponse({\n    status: 200,\n    description:\n      'Classes created/updated. Returns count and the processed classes.',\n  })\n  @Post('batch-upsert')\n  async batchUpsert(@Body() batchDto: BatchUpsertClassDto) {\n    return await this.classesService.batchUpsert(batchDto.classes);\n  }\n\n  @ApiOperation({ summary: 'Batch create classes' })\n  @ApiBody({ type: [CreateClassDto] })\n  @ApiResponse({ status: 201, description: 'Classes created' })\n  @Post('batch')\n  async batchCreate(@Body() classes: CreateClassDto[]) {\n    return await this.classesService.batchCreate(classes);\n  }\n}\n"],"names":["ClassesController","getAll","groupId","gid","undefined","Number","classesService","findAll","getOne","id","findOne","create","body","update","delete","remove","message","setAttendance","attendedStudentsIds","batchUpsert","batchDto","classes","batchCreate","summary","name","required","description","status","type","CreateClassDto","UpdateClassDto","BatchUpsertClassDto"],"mappings":";;;;+BAyBaA;;;eAAAA;;;wBAhBN;yBAQA;gCACwB;qCACK;gCACL;gCACA;;;;;;;;;;;;;;;AAIxB,IAAA,AAAMA,oBAAN,MAAMA;IAGX,MAWMC,OAAO,AAAkBC,OAAgB,EAAE;QAC/C,MAAMC,MAAMD,YAAYE,YAAYC,OAAOH,WAAWE;QACtD,OAAO,MAAM,IAAI,CAACE,cAAc,CAACC,OAAO,CAACJ;IAC3C;IAEA,MAIMK,OAAO,AAAaC,EAAU,EAAE;QACpC,OAAO,MAAM,IAAI,CAACH,cAAc,CAACI,OAAO,CAAC,CAACD;IAC5C;IAEA,MAIME,OAAO,AAAQC,IAAoB,EAAE;QACzC,OAAO,MAAM,IAAI,CAACN,cAAc,CAACK,MAAM,CAACC;IAC1C;IAEA,MAKMC,OAAO,AAAaJ,EAAU,EAAE,AAAQG,IAAoB,EAAE;QAClE,OAAO,MAAM,IAAI,CAACN,cAAc,CAACO,MAAM,CAAC,CAACJ,IAAIG;IAC/C;IAEA,MAIME,OAAO,AAAaL,EAAU,EAAE;QACpC,MAAM,IAAI,CAACH,cAAc,CAACS,MAAM,CAAC,CAACN;QAClC,OAAO;YAAEO,SAAS;QAA6B;IACjD;IAEA,MAKMC,cACJ,AAAaR,EAAU,EACvB,AAAQS,mBAA6B,EACrC;QACA,OAAO,MAAM,IAAI,CAACZ,cAAc,CAACW,aAAa,CAAC,CAACR,IAAIS;IACtD;IAEA,MAUMC,YAAY,AAAQC,QAA6B,EAAE;QACvD,OAAO,MAAM,IAAI,CAACd,cAAc,CAACa,WAAW,CAACC,SAASC,OAAO;IAC/D;IAEA,MAIMC,YAAY,AAAQD,OAAyB,EAAE;QACnD,OAAO,MAAM,IAAI,CAACf,cAAc,CAACgB,WAAW,CAACD;IAC/C;IApFA,YAAY,AAAiBf,cAA8B,CAAE;aAAhCA,iBAAAA;IAAiC;AAqFhE;;;QAnFkBiB,SAAS;;;QAEvBC,MAAM;QACNC,UAAU;QACVC,aAAa;;;QAGbC,QAAQ;QACRD,aAAa;;;;;;;;;;;;QAQCH,SAAS;;;QACbC,MAAM;QAAME,aAAa;;;QACtBC,QAAQ;QAAKD,aAAa;;;;;;;;;;;;QAMzBH,SAAS;;;QACdK,MAAMC,8BAAc;;;QAChBF,QAAQ;QAAKD,aAAa;;;;;;;;;;;;QAMzBH,SAAS;;;QACbC,MAAM;QAAME,aAAa;;;QAC1BE,MAAME,8BAAc;;;QAChBH,QAAQ;QAAKD,aAAa;;;;;;;;;;;;;;QAMzBH,SAAS;;;QACbC,MAAM;QAAME,aAAa;;;QACtBC,QAAQ;QAAKD,aAAa;;;;;;;;;;;;QAOzBH,SAAS;;;QACbC,MAAM;QAAME,aAAa;;;QAC1BE,MAAM;YAACvB;SAAO;;;QACVsB,QAAQ;QAAKD,aAAa;;;;;;;;;;;;;;QAUvCH,SAAS;;;QAEAK,MAAMG,wCAAmB;;;QAElCJ,QAAQ;QACRD,aACE;;;;;;;;;;;;QAOYH,SAAS;;;QACdK,MAAM;YAACC,8BAAc;SAAC;;;QAClBF,QAAQ;QAAKD,aAAa"}