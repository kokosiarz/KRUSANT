{"version":3,"sources":["../../src/students/students.controller.ts"],"sourcesContent":["import { Body, Controller, Param, Query, UseGuards } from '@nestjs/common';\nimport { Get, Post, Patch, Delete } from '@nestjs/common';\nimport {\n  ApiTags,\n  ApiOperation,\n  ApiResponse,\n  ApiParam,\n  ApiQuery,\n  ApiBody,\n} from '@nestjs/swagger';\nimport { CreateStudentDto } from './dto/create-student.dto';\nimport { UpdateStudentDto } from './dto/update-student.dto';\nimport { BatchUpsertStudentDto } from './dto/batch-upsert-student.dto';\nimport { StudentsService } from './students.service';\nimport { AuthGuard } from '@nestjs/passport';\nimport { StudentWithBalanceDto } from './dto/student-with-balance.dto';\n\n@ApiTags('students')\n@Controller('students')\n@UseGuards(AuthGuard('jwt'))\nexport class StudentsController {\n  constructor(private readonly studentsService: StudentsService) {}\n  @ApiOperation({ summary: 'Get all students' })\n  @ApiQuery({\n    name: 'active',\n    required: false,\n    enum: ['true', 'false'],\n    description: 'Filter by active status',\n  })\n  @ApiResponse({\n    status: 200,\n    description: 'Returns all students or filtered by active status',\n  })\n  @Get()\n  async getAll(@Query('active') active?: 'true' | 'false') {\n    const isActive = active === 'true' ? true : undefined;\n    return await this.studentsService.findAll(isActive);\n  }\n\n  @ApiOperation({ summary: 'Get all students with financial balance' })\n  @ApiQuery({\n    name: 'active',\n    required: false,\n    enum: ['true', 'false'],\n    description: 'Filter by active status',\n  })\n  @ApiResponse({\n    status: 200,\n    description: 'Returns all students with their financial balance',\n    type: [StudentWithBalanceDto],\n  })\n  @Get('with-balance')\n  async getAllWithBalance(@Query('active') active?: 'true' | 'false') {\n    const isActive = active === 'true' ? true : undefined;\n    return await this.studentsService.findAllWithBalance(isActive);\n  }\n\n  @ApiOperation({ summary: 'Get student by email' })\n  @ApiQuery({\n    name: 'email',\n    description: 'Student email',\n    example: 'student@example.com',\n  })\n  @ApiResponse({ status: 200, description: 'Returns student' })\n  @ApiResponse({ status: 404, description: 'Student not found' })\n  @Get('search')\n  async getByEmail(@Query('email') email: string) {\n    return await this.studentsService.findByEmail(email);\n  }\n\n  @ApiOperation({ summary: 'Get student by ID' })\n  @ApiParam({ name: 'id', description: 'Student ID' })\n  @ApiResponse({ status: 200, description: 'Returns student' })\n  @Get(':id')\n  async getOne(@Param('id') id: string) {\n    return await this.studentsService.findOne(+id);\n  }\n\n  @ApiOperation({ summary: 'Create new student' })\n  @ApiBody({ type: CreateStudentDto })\n  @ApiResponse({ status: 201, description: 'Student created' })\n  @Post()\n  async create(@Body() student: CreateStudentDto) {\n    return await this.studentsService.create(student);\n  }\n\n  @ApiOperation({ summary: 'Update student' })\n  @ApiParam({ name: 'id', description: 'Student ID' })\n  @ApiBody({ type: UpdateStudentDto })\n  @ApiResponse({ status: 200, description: 'Student updated' })\n  @Patch(':id')\n  async update(@Param('id') id: string, @Body() student: UpdateStudentDto) {\n    return await this.studentsService.update(+id, student);\n  }\n\n  @ApiOperation({ summary: 'Delete student' })\n  @ApiParam({ name: 'id', description: 'Student ID' })\n  @ApiResponse({ status: 200, description: 'Student deleted' })\n  @Delete(':id')\n  async deleteStudent(@Param('id') id: string) {\n    await this.studentsService.remove(+id);\n    return { message: 'Student deleted successfully' };\n  }\n\n  @ApiOperation({ summary: 'Batch create or update students by email' })\n  @ApiBody({ type: BatchUpsertStudentDto })\n  @ApiResponse({\n    status: 200,\n    description:\n      'Students created/updated. Returns count and the processed students.',\n  })\n  @Post('batch-upsert')\n  async batchUpsert(@Body() batchDto: BatchUpsertStudentDto) {\n    return await this.studentsService.batchUpsert(batchDto.students);\n  }\n}\n"],"names":["StudentsController","getAll","active","isActive","undefined","studentsService","findAll","getAllWithBalance","findAllWithBalance","getByEmail","email","findByEmail","getOne","id","findOne","create","student","update","deleteStudent","remove","message","batchUpsert","batchDto","students","summary","name","required","enum","description","status","type","StudentWithBalanceDto","example","CreateStudentDto","UpdateStudentDto","BatchUpsertStudentDto"],"mappings":";;;;+BAoBaA;;;eAAAA;;;wBApB6C;yBASnD;kCAC0B;kCACA;uCACK;iCACN;0BACN;uCACY;;;;;;;;;;;;;;;AAK/B,IAAA,AAAMA,qBAAN,MAAMA;IAEX,MAYMC,OAAO,AAAiBC,MAAyB,EAAE;QACvD,MAAMC,WAAWD,WAAW,SAAS,OAAOE;QAC5C,OAAO,MAAM,IAAI,CAACC,eAAe,CAACC,OAAO,CAACH;IAC5C;IAEA,MAaMI,kBAAkB,AAAiBL,MAAyB,EAAE;QAClE,MAAMC,WAAWD,WAAW,SAAS,OAAOE;QAC5C,OAAO,MAAM,IAAI,CAACC,eAAe,CAACG,kBAAkB,CAACL;IACvD;IAEA,MASMM,WAAW,AAAgBC,KAAa,EAAE;QAC9C,OAAO,MAAM,IAAI,CAACL,eAAe,CAACM,WAAW,CAACD;IAChD;IAEA,MAIME,OAAO,AAAaC,EAAU,EAAE;QACpC,OAAO,MAAM,IAAI,CAACR,eAAe,CAACS,OAAO,CAAC,CAACD;IAC7C;IAEA,MAIME,OAAO,AAAQC,OAAyB,EAAE;QAC9C,OAAO,MAAM,IAAI,CAACX,eAAe,CAACU,MAAM,CAACC;IAC3C;IAEA,MAKMC,OAAO,AAAaJ,EAAU,EAAE,AAAQG,OAAyB,EAAE;QACvE,OAAO,MAAM,IAAI,CAACX,eAAe,CAACY,MAAM,CAAC,CAACJ,IAAIG;IAChD;IAEA,MAIME,cAAc,AAAaL,EAAU,EAAE;QAC3C,MAAM,IAAI,CAACR,eAAe,CAACc,MAAM,CAAC,CAACN;QACnC,OAAO;YAAEO,SAAS;QAA+B;IACnD;IAEA,MAQMC,YAAY,AAAQC,QAA+B,EAAE;QACzD,OAAO,MAAM,IAAI,CAACjB,eAAe,CAACgB,WAAW,CAACC,SAASC,QAAQ;IACjE;IA7FA,YAAY,AAAiBlB,eAAgC,CAAE;aAAlCA,kBAAAA;IAAmC;AA8FlE;;;QA7FkBmB,SAAS;;;QAEvBC,MAAM;QACNC,UAAU;QACVC,MAAM;YAAC;YAAQ;SAAQ;QACvBC,aAAa;;;QAGbC,QAAQ;QACRD,aAAa;;;;;;;;;;;;QAQCJ,SAAS;;;QAEvBC,MAAM;QACNC,UAAU;QACVC,MAAM;YAAC;YAAQ;SAAQ;QACvBC,aAAa;;;QAGbC,QAAQ;QACRD,aAAa;QACbE,MAAM;YAACC,4CAAqB;SAAC;;;;;;;;;;;;QAQfP,SAAS;;;QAEvBC,MAAM;QACNG,aAAa;QACbI,SAAS;;;QAEIH,QAAQ;QAAKD,aAAa;;;QAC1BC,QAAQ;QAAKD,aAAa;;;;;;;;;;;;QAMzBJ,SAAS;;;QACbC,MAAM;QAAMG,aAAa;;;QACtBC,QAAQ;QAAKD,aAAa;;;;;;;;;;;;QAMzBJ,SAAS;;;QACdM,MAAMG,kCAAgB;;;QAClBJ,QAAQ;QAAKD,aAAa;;;;;;;;;;;;QAMzBJ,SAAS;;;QACbC,MAAM;QAAMG,aAAa;;;QAC1BE,MAAMI,kCAAgB;;;QAClBL,QAAQ;QAAKD,aAAa;;;;;;;;;;;;;;QAMzBJ,SAAS;;;QACbC,MAAM;QAAMG,aAAa;;;QACtBC,QAAQ;QAAKD,aAAa;;;;;;;;;;;;QAOzBJ,SAAS;;;QACdM,MAAMK,4CAAqB;;;QAEpCN,QAAQ;QACRD,aACE"}